<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Pedido de Sorvetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
        background: #f2f3f7;
        padding: 16px;
        max-width: 480px;
        margin: auto;
        padding-bottom: 140px;
    }

    h1 {
        text-align: center;
        font-size: 28px;
        font-weight: 800;
        margin-bottom: 20px;
        color: #1a1a1a;
    }

    /* --- Botões de categoria estilo iOS --- */
    .cat-btn {
        width: 100%;
        background: #ffffff;
        padding: 18px;
        font-size: 19px;
        border: none;
        border-radius: 18px;
        margin-top: 16px;
        cursor: pointer;
        font-weight: 600;
        color: #333;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.10);
        transition: 0.2s;
    }

    .cat-btn:active {
        transform: scale(0.98);
        background: #f8f8f8;
    }

    .seta {
        font-size: 20px;
        transition: transform 0.2s;
        color: #007aff;
    }

    /* --- Área oculta da categoria --- */
    .categoria {
        display: none;
        background: #ffffff;
        padding: 16px;
        border-radius: 18px;
        margin-top: 10px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.10);
    }

    /* --- Item --- */
    .item {
        padding: 14px 0;
        border-bottom: 1px solid #ececec;
    }

    .item:last-child {
        border-bottom: none;
    }

    .nome {
        font-size: 18px;
        font-weight: 600;
        color: #222;
    }

    .valor {
        font-size: 16px;
        color: #007aff;
        font-weight: 700;
        margin-top: 4px;
    }

    /* --- Controles (+ -) --- */
    .controls {
        display: flex;
        align-items: center;
        margin-top: 10px;
        gap: 10px;
    }

    .btn {
        width: 42px;
        height: 42px;
        border-radius: 14px;
        border: none;
        font-size: 26px;
        font-weight: 700;
        cursor: pointer;
        touch-action: manipulation;
    }

    .menos {
        background: #ff3b30;
        color: white;
    }

    .mais {
        background: #34c759;
        color: white;
    }

    .numero {
        width: 42px;
        text-align: center;
        font-size: 20px;
        font-weight: 700;
        color: #333;
    }

    /* --- Barra fixa --- */
    #barra-fixa {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        max-width: 480px;
        margin: auto;
        background: #007aff;
        padding: 18px;
        color: white;
        font-size: 20px;
        font-weight: 700;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-radius: 20px 20px 0 0;
        box-shadow: 0 -6px 20px rgba(0,0,0,0.25);
    }

    #ver-pedido-btn {
        background: white;
        color: #007aff;
        padding: 10px 18px;
        border-radius: 14px;
        font-size: 17px;
        font-weight: 700;
        border: none;
        cursor: pointer;
    }

    #limpar {
        width: 100%;
        margin-top: 20px;
        padding: 14px;
        background: #ff3b30;
        color: white;
        font-size: 18px;
        border: none;
        border-radius: 14px;
        font-weight: bold;
        cursor: pointer;
    }

    #resumo {
        display: none;
        white-space: pre-wrap;
    }
</style>
</head>
<body>

<h1>Pedido de Sorvetes</h1>

<div id="conteudo"></div>

<div id="resumo">Nenhum item selecionado.</div>

<button id="limpar" onclick="limparTudo()">LIMPAR</button>

<div id="barra-fixa">
    <span id="total-barra">R$ 0,00</span>
    <button id="ver-pedido-btn" onclick="alert(resumo.innerText)">Ver pedido</button>
</div>

<script>
/* ------------------- PREÇOS ------------------- */
const precoPorCategoria = {
    "PALETAS FRUTIVERÃO": 18,
    "AO LEITE FRUTIVERÃO": 8,
    "TROPICAL FRUTIVERÃO": 6,
    "ESPECIAL FRUTVERÃO": 13,
    "LANÇAMENTOS": null
};

const precosLancamentos = { "Pistache": 16, "Unicórnio": 10 };

/* ------------------- CATEGORIAS ------------------- */
const categorias = {
    "PALETAS FRUTIVERÃO": [
        "Raffaello","Oreo","Ferrero","Kinder Ovo","Kinder Bueno","M&M","Choco Maltine",
        "Milk Trufado","Babalu","Blue Ice","Sensação","Morango","Maracujá","Açaí",
        "Iogurte c/ Amora","Menta c/ Chocolate","Paçoca","Capuccino","Banana com Avelã",
        "Coco c/ Abobora","Coco c/ Doce de Leite","Tapioca","Abacaxi Zero"
    ],
    "AO LEITE FRUTIVERÃO": [
        "Morango","Chocolate","Leite Condensado","Milho-Verde","Açaí c/ Morango",
        "Coco","Coco Queimado","Abóbora c/ Coco","Amendoim","Abacate","Blue Ice"
    ],
    "TROPICAL FRUTIVERÃO": [
        "Uva","Limão","Maracujá","Manga","Abacaxi","Melancia","Tangerina",
        "Maçã Verde","Groselha","Tutti Frutti","Pinta Língua"
    ],
    "ESPECIAL FRUTVERÃO": [
        "Skimo morango","Skimo ao leite","Milk trufado","Brigadeiro","Chococo",
        "Torta de limão","Itu napolitano","Frutblito","Sunday de chocolate","Sundae de Morango"
    ],
    "LANÇAMENTOS": ["Pistache","Unicórnio"]
};

let vendidoSalvo = JSON.parse(localStorage.getItem("vendido")) || {};
let idGlobal = 1;

/* ------------------- MONTAR INTERFACE ------------------- */
function montarInterface() {
    const conteudo = document.getElementById("conteudo");

    for (let cat in categorias) {
        const bt = document.createElement("button");
        bt.className = "cat-btn";
        bt.innerHTML = `${cat} <span class="seta" id="seta_${cat}">▶</span>`;
        bt.onclick = () => toggle(cat);
        conteudo.appendChild(bt);

        const bloco = document.createElement("div");
        bloco.id = "cat_" + cat;
        bloco.className = "categoria";

        categorias[cat].forEach(sabor => {
            const item = document.createElement("div");
            item.className = "item";

            const preco = cat === "LANÇAMENTOS"
                ? precosLancamentos[sabor]
                : precoPorCategoria[cat];

            const v = vendidoSalvo[idGlobal] || 0;

            item.innerHTML = `
                <div class="nome">${sabor}</div>
                <div class="valor">Preço: R$ ${preco}</div>
                <div class="controls">
                    <button class="btn menos" onclick="remove(${idGlobal})">-</button>
                    <span class="numero" id="vend_${idGlobal}">${v}</span>
                    <button class="btn mais" onclick="add(${idGlobal})">+</button>
                </div>
            `;

            bloco.appendChild(item);
            idGlobal++;
        });

        conteudo.appendChild(bloco);
    }
}

montarInterface();
gerarResumo();

/* ------------------- FUNÇÕES ------------------- */
function toggle(cat) {
    const el = document.getElementById("cat_" + cat);
    const seta = document.getElementById("seta_" + cat);

    const aberto = el.style.display === "block";
    el.style.display = aberto ? "none" : "block";
    seta.style.transform = aberto ? "rotate(0deg)" : "rotate(90deg)";
}

function add(id) {
    const campo = document.getElementById("vend_" + id);
    campo.innerText = Number(campo.innerText) + 1;
    vendidoSalvo[id] = Number(campo.innerText);
    salvar();
    gerarResumo();
}

function remove(id) {
    const campo = document.getElementById("vend_" + id);
    if (Number(campo.innerText) > 0) campo.innerText--;
    vendidoSalvo[id] = Number(campo.innerText);
    salvar();
    gerarResumo();
}

function salvar() {
    localStorage.setItem("vendido", JSON.stringify(vendidoSalvo));
}

function gerarResumo() {
    let texto = "";
    let total = 0;
    let i = 1;

    for (let cat in categorias) {
        let blocos = "";

        categorias[cat].forEach(sabor => {
            const q = vendidoSalvo[i] || 0;
            if (q > 0) {
                blocos += `${q} - ${sabor}\n`;

                const preco = cat === "LANÇAMENTOS"
                    ? precosLancamentos[sabor]
                    : precoPorCategoria[cat];

                total += q * preco;
            }
            i++;
        });

        if (blocos !== "") texto += `${cat}\n${blocos}\n`;
    }

    texto += `TOTAL: R$ ${total.toFixed(2)}`;
    document.getElementById("resumo").innerText = texto;

    atualizarBarraFixa(total);
}

function atualizarBarraFixa(total) {
    document.getElementById("total-barra").innerText = "R$ " + total.toFixed(2);
}

function limparTudo() {
    localStorage.clear();
    location.reload();
}
</script>

</body>
</html>