<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle de Sorvetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f7;
    padding: 12px;
    color: #333;
    max-width: 480px;
    margin: auto;
}

h1 {
    text-align: center;
    margin-bottom: 20px;
    font-size: 26px;
    font-weight: 900;
}

/* BOTÃO CATEGORIA */
.cat-btn {
    width: 100%;
    background: #007aff;
    color: white;
    padding: 12px 14px;
    font-size: 17px;
    border: none;
    border-radius: 12px;
    margin-top: 12px;
    cursor: pointer;
    font-weight: 700;
}

.cat-btn.ativo {
    background: #34c759;
    position: sticky;
    top: 10px;
    z-index: 50;
}

.categoria {
    display: none;
    margin-top: 6px;
    background: #ffffff;
    padding: 6px;
    border-radius: 12px;
}

/* ITEM */
.item {
    background: #fff;
    padding: 8px;
    margin: 6px 0;
    border-radius: 12px;
}

.item.zero {
    background: #ff4d4d !important;
    color: white !important;
}

.item.card {
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

.info { flex: 1; }

.nome {
    font-size: 17px;
    font-weight: 800;
}

.valor {
    font-size: 14px;
    font-weight: 700;
    color: #007aff;
}

.item.zero .valor {
    color: #fff;
}

.restante {
    font-size: 16px;
    font-weight: 800;
}

/* PAINEL */
.painel {
    background: #f1f1f1;
    padding: 8px;
    border-radius: 10px;
    min-width: 150px;
}

.linha {
    display: flex;
    justify-content: space-between;
    margin-top: 6px;
}

.controls {
    display: flex;
    align-items: center;
    gap: 6px;
}

input[type="number"] {
    width: 60px;
    padding: 6px;
    border-radius: 6px;
    border: none;
    font-size: 16px;
    font-weight: 800;
    text-align: center;
}

.numero {
    font-weight: 800;
}

.btn {
    width: 28px;
    height: 28px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 18px;
    font-weight: 800;
}

#totalVendas {
    margin-top: 14px;
    padding: 14px;
    background: #e6fff0;
    border-radius: 12px;
    font-size: 18px;
    text-align: center;
    font-weight: 800;
    color: #0b6b1a;
}

#limpar {
    width: 100%;
    padding: 12px;
    font-size: 17px;
    border: none;
    border-radius: 12px;
    margin-top: 16px;
    background: #ff3b30;
    color: white;
}
</style>

<script>
let precoPorCategoria = {
    "FRUTARE": 10,
    "FRUTILLY": 7.5
};

let precosLancamentos = {
    "Clássico": 20,"Branco": 20,"Avelã": 20,"Amêndoas": 20,
    "Cookies & Cream": 20,"Menos Açúcar": 20,"Pistache": 21,
    "Choco Mix": 13,"Chocante": 13,"Uni Cornetto": 16.5,
    "M&Ms": 16.5,"Brigadeiro Cornetto": 16.5,
    "Mini Eski-bon": 17,"Mini Morango": 17,"Mini Chicabon": 17,
    "Mini Doce de Leite": 17,"Eski-bon": 12,"Brigadeiro": 12,
    "Chicabon": 12,"Chicabon Menos Açúcar": 12,
    "3 Chocolates": 12.5,"Max Avelã": 12.5,"Tablito": 12.5,
    "Expecto": 10,"Grifinória": 11,"Sonserina": 11
};

let categorias = {
    "MAGNUM": ["Clássico","Branco","Avelã","Amêndoas","Cookies & Cream","Menos Açúcar","Pistache"],
    "CORNETTO": ["Choco Mix","Chocante","Uni Cornetto","M&Ms","Brigadeiro Cornetto"],
    "OS FAVORITOS": ["Mini Eski-bon","Mini Morango","Mini Chicabon","Mini Doce de Leite","Eski-bon","Brigadeiro","Chicabon","Chicabon Menos Açúcar","3 Chocolates","Max Avelã","Tablito"],
    "FRUTARE": ["Tangerina","Limão","Morango","Abacaxi","Uva","Coco"],
    "FRUTILLY": ["Frutilly","Frutilly Pinta Língua"],
    "HARRY POTTER": ["Expecto","Grifinória","Sonserina"]
};

let id=1, total=0;

function toggle(cat){
    document.querySelectorAll(".categoria").forEach(c=>c.style.display="none");
    document.querySelectorAll(".cat-btn").forEach(b=>b.classList.remove("ativo"));

    let el=document.getElementById("cat_"+cat);
    el.style.display="block";
    document.getElementById("btn_"+cat).classList.add("ativo");
}

function atualizar(i){
    let est = +document.getElementById("est_"+i).value || 0;
    let vend = +document.getElementById("vend_"+i).innerText;
    let r = Math.max(0, est - vend);

    document.getElementById("resto_"+i).innerText = "Restante: " + r;
    document.getElementById("item_"+i).classList.toggle("zero", r === 0);
    recalcular();
}

function addVend(i){
    document.getElementById("vend_"+i).innerText++;
    atualizar(i);
}

function removeVend(i){
    let v = document.getElementById("vend_"+i);
    if(+v.innerText>0) v.innerText--;
    atualizar(i);
}

function recalcular(){
    let i=1; total=0;
    for(let c in categorias){
        categorias[c].forEach(s=>{
            let p = precoPorCategoria[c] ?? precosLancamentos[s];
            total += +document.getElementById("vend_"+i).innerText * p;
            i++;
        });
    }
    document.getElementById("valorTotal").innerText = total.toFixed(2);
}
</script>
</head>

<body>

<h1>Controle de Sorvetes</h1>

<div id="conteudo">
<script>
for(let c in categorias){
document.write(`<button id="btn_${c}" class="cat-btn" onclick="toggle('${c}')">${c}</button><div id="cat_${c}" class="categoria">`);
categorias[c].forEach(s=>{
let p = precoPorCategoria[c] ?? precosLancamentos[s];
document.write(`
<div class="item card zero" id="item_${id}">
<div class="info">
<div class="nome">${s}</div>
<div class="valor">Preço: R$ ${p.toFixed(2)}</div>
<div class="restante" id="resto_${id}">Restante: 0</div>
</div>

<div class="painel">
<div class="linha">
<div class="controls">
<span>Estoque</span>
<input type="number" id="est_${id}" min="0" value="0" oninput="atualizar(${id})">
</div>
</div>

<div class="linha">
<div class="controls">
<span>Vendido</span>
<button class="btn" onclick="removeVend(${id})">-</button>
<span class="numero" id="vend_${id}">0</span>
<button class="btn" onclick="addVend(${id})">+</button>
</div>
</div>
</div>
</div>`);
id++;
});
document.write("</div>");
}
</script>
</div>

<div id="totalVendas">TOTAL EM VENDAS: R$ <span id="valorTotal">0.00</span></div>

<button id="limpar" onclick="location.reload()">LIMPAR TUDO</button>

</body>
</html>