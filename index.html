<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle de Vendas</title>

<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    padding: 20px;
}
.container {
    max-width: 420px;
    margin: auto;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
}
h2 { text-align: center; }
label {
    font-weight: bold;
    margin-top: 10px;
    display: block;
}
input {
    width: 100%;
    padding: 12px;
    margin-top: 5px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 16px; /* evita zoom no iPhone */
}
.resultado {
    margin-top: 10px;
    background: #f0f0f0;
    padding: 10px;
    border-radius: 5px;
}
.resultado span {
    font-weight: bold;
    float: right;
}
button {
    width: 100%;
    padding: 14px;
    margin-top: 12px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
}
.btn-whatsapp { background: #25D366; color: #fff; }
.btn-limpar { background: #c62828; color: #fff; }
.clear { clear: both; }
</style>
</head>

<body>
<div class="container">
<h2>Controle de Vendas</h2>

<label>Dinheiro inicial (espÃ©cie)</label>
<input type="number" id="dinheiroInicial" step="0.01">

<label>Dinheiro final (fim do dia)</label>
<input type="number" id="dinheiroFinal" step="0.01">

<label>Valor vendido no cartÃ£o</label>
<input type="number" id="cartao" step="0.01">

<label>Valor gasto em R$</label>
<input type="number" id="gasto" step="0.01">

<label>Gelo seco (desconto)</label>
<input type="number" id="geloSeco" step="0.01">

<div class="resultado">ğŸ’µ Dinheiro vendido <span id="dinheiroVendido">R$ 0,00</span><div class="clear"></div></div>
<div class="resultado">ğŸ’³ CartÃ£o <span id="cartaoTotal">R$ 0,00</span><div class="clear"></div></div>
<div class="resultado">ğŸ’° Total vendido <span id="totalVendido">R$ 0,00</span><div class="clear"></div></div>
<div class="resultado">ğŸ“Š ComissÃ£o (25%) <span id="comissao">R$ 0,00</span><div class="clear"></div></div>
<div class="resultado">â„ï¸ ComissÃ£o final <span id="comissaoFinal">R$ 0,00</span><div class="clear"></div></div>
<div class="resultado">ğŸª Valor P/ Kibon <span id="valorKibon">R$ 0,00</span><div class="clear"></div></div>

<button class="btn-whatsapp" onclick="enviarWhats()">Enviar relatÃ³rio</button>
<button class="btn-limpar" onclick="limpar()">Limpar tudo</button>
</div>

<script>
const campos = [
  "dinheiroInicial",
  "dinheiroFinal",
  "cartao",
  "gasto",
  "geloSeco"
];

// carregar dados salvos
window.onload = () => {
    campos.forEach(id => {
        const v = localStorage.getItem(id);
        if (v !== null) document.getElementById(id).value = v;
    });
    calcular();
};

// salvar automaticamente ao digitar
campos.forEach(id => {
    document.getElementById(id).addEventListener("input", () => {
        localStorage.setItem(id, document.getElementById(id).value);
        calcular();
    });
});

function calcular() {
    let di = +dinheiroInicial.value || 0;
    let df = +dinheiroFinal.value || 0;
    let cartaoV = +cartao.value || 0;
    let gastoV = +gasto.value || 0;
    let gelo = +geloSeco.value || 0;

    let dinheiroVendido = Math.max(df - di, 0);

    // TOTAL REAL DE VENDAS
    let total = dinheiroVendido + cartaoV + gastoV;

    let comissao = total * 0.25;
    let comissaoFinal = Math.max(comissao - gelo, 0);
    let kibon = Math.max(total - comissaoFinal, 0);

    dinheiroVendidoEl.innerText = fmt(dinheiroVendido);
    cartaoTotalEl.innerText = fmt(cartaoV);
    totalVendidoEl.innerText = fmt(total);
    comissaoEl.innerText = fmt(comissao);
    comissaoFinalEl.innerText = fmt(comissaoFinal);
    valorKibonEl.innerText = fmt(kibon);
}

function enviarWhats() {
    let texto =
`ğŸ“Š *RelatÃ³rio de Vendas*
ğŸ’µ Dinheiro: ${dinheiroVendidoEl.innerText}
ğŸ’³ CartÃ£o: ${cartaoTotalEl.innerText}
ğŸ’¸ Gasto: ${fmt(+gasto.value || 0)}
ğŸ’° Total: ${totalVendidoEl.innerText}
ğŸ“Š ComissÃ£o: ${comissaoEl.innerText}
â„ï¸ Gelo seco: ${fmt(+geloSeco.value || 0)}
âœ… ComissÃ£o final: ${comissaoFinalEl.innerText}
ğŸª Valor P/ Kibon: ${valorKibonEl.innerText}`;

    window.open("https://wa.me/?text=" + encodeURIComponent(texto), "_blank");
}

function limpar() {
    if (confirm("Tem certeza que deseja limpar todos os dados?")) {
        localStorage.clear();
        location.reload();
    }
}

function fmt(v) {
    return v.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
}

const dinheiroInicial = document.getElementById("dinheiroInicial");
const dinheiroFinal = document.getElementById("dinheiroFinal");
const cartao = document.getElementById("cartao");
const gasto = document.getElementById("gasto");
const geloSeco = document.getElementById("geloSeco");

const dinheiroVendidoEl = document.getElementById("dinheiroVendido");
const cartaoTotalEl = document.getElementById("cartaoTotal");
const totalVendidoEl = document.getElementById("totalVendido");
const comissaoEl = document.getElementById("comissao");
const comissaoFinalEl = document.getElementById("comissaoFinal");
const valorKibonEl = document.getElementById("valorKibon");
</script>
</body>
</html>